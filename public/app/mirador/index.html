<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <link rel="stylesheet" type="text/css" href="build/mirador/css/mirador-combined.css">
  <title>IIIF Showcase - Mirador Viewer</title>
  <style type="text/css">
    body { padding: 0; margin: 0; overflow: hidden; font-size: 70%; }
    #viewer { background: #333 url(images/debut_dark.png) left top repeat; width: 100%; height: 100%; position: fixed; }
  </style>
</head>
<body>
  <div id="viewer"></div>

  <script src="build/mirador/mirador.js"></script>
  <script type="text/javascript">

	var qs = (function(a) {
	    if (a == "") return {};
	    var b = {};
	    for (var i = 0; i < a.length; ++i)
	    {
		var p=a[i].split('=', 2);
		if (p.length == 1)
		    b[p[0]] = "";
		else
		    b[p[0]] = decodeURIComponent(p[1].replace(/\+/g, " "));
	    }
	    return b;
	})(window.location.search.substr(1).split('&'));

	function initialize(manifestsLinks) {
	      console.log('Using Manifests: ' + JSON.stringify(manifestsLinks));
	      var windowObjects = [];
	      if ( manifestsLinks.length === 1 ) {
		var chosen = manifestsLinks[0];
		// It's a single link - we can show it to start with...
		var winObject = {
			loadedManifest: chosen.manifestUri,
			viewType: 'BookView'
		};
		windowObjects.push(winObject);
	      }

	      Mirador({
		"id": "viewer",
		"layout": "1x1",
		"mainMenuSettings" :
		  {"show": true,
		   "buttons" : {"bookmark" : true, "layout" : true},
		   "userButtons": [ ],
		   "userLogo": {"label": "IIIF", "attributes": {"href": "http://iiif.io"}}
		 },
		'showAddFromURLBox' : false,
		"saveSession": true,
		"data": manifestsLinks,
		"windowObjects": windowObjects
	      });
	}

        if ( qs['json'] || location.hash ) {
  	      // It's a bookmark - let mirador take care of it
		console.log("Creating viewer and hoping he knows what to do...");
	      Mirador({
		"id": "viewer",
		"layout": "1x2",
		"data": [
		  { "location": "The Frick Collection"},
		],
		"windowObjects": []
	      });
	}

  </script>
</body>
</html>
